"use strict";!function(t){var i=void 0,h={star_r:3,star_alpha:5,initStarsPopulation:150,move_distance:.25,dot_r:5,dot_speeds:.5,dot_alpha:.5,dot_aReduction:.01,dotsMinDist:5,maxDistFromCursor:50},s=[],o=[],a=document.getElementById("canvas"),e=a.getContext("2d"),r=void 0,n=void 0,d=!1,c=void 0,l=void 0,u=void 0;function C(){}function f(t,i,s,o){this.id=t,this.x=i,this.y=s,this.useCacha=o,this.cacheCanvas=document.createElement("canvas"),this.cacheCtx=this.cacheCanvas.getContext("2d"),this.r=Math.floor(Math.random()*h.star_r)+1,this.cacheCtx.width=6*this.r,this.cacheCtx.height=6*this.r;var a=(Math.floor(10*Math.random())+1)/h.star_alpha;this.color="rgba(255,255,255,"+a+")",o&&this.cache()}function x(t,i,s,o){this.id=t,this.x=i,this.y=s,this.r=Math.floor(Math.random()*h.dot_r)+1,this.speed=h.dot_speeds,this.a=h.dot_alpha,this.aReduction=h.dot_aReduction,this.useCache=o,this.dotCanvas=document.createElement("canvas"),this.dotCtx=this.dotCanvas.getContext("2d"),this.dotCtx.width=6*this.r,this.dotCtx.height=6*this.r,this.dotCtx.a=.5,this.color="rgba(255,255,255,"+this.a+")",this.dotCtx.color="rgba(255,255,255,"+this.dotCtx.a+")",this.linkColor="rgba(255,255,255,"+this.a/4+")",this.dir=Math.floor(140*Math.random())+200,o&&this.cache()}function m(t,i){return!(0==t||t-i<0)&&(void 0!==o[t-i]&&o[t-i])}function v(){for(var t in e.clearRect(0,0,r,n),s)s[t].move();for(var i in o)o[i].move();!function(){if(d){if(0==o.length)return o[0]=new x(0,l,u,!0),void o[0].draw();var t=m(o.length,1),i=t.x,s=t.y,a=Math.abs(i-l),e=Math.abs(s-u);if(!(a<h.dotsMinDist||e<h.dotsMinDist)){var r=Math.random()>.5?-1:1;r=r*Math.floor(Math.random()*h.maxDistFromCursor)+1;var n=Math.random()>.5?-1:1;n=n*Math.floor(Math.random()*h.maxDistFromCursor)+1,o[o.length]=new x(o.length,l+r,u+n,!0),o[o.length-1].draw(),o[o.length-1].link()}}}(),requestAnimationFrame(v)}function w(t){return t*(Math.PI/180)}C.prototype.init=function(t){!function(t){if(t instanceof Object)for(var i in t)h[i]=t[i]}(t),e.strokeStyle="white",e.shadowColor="white";for(var i=0;i<h.initStarsPopulation;i++)s[i]=new f(i,Math.floor(Math.random()*r),Math.floor(Math.random()*n),!0);e.shadowBlur=0,v()},f.prototype={draw:function(){this.useCacha?e.drawImage(this.cacheCanvas,this.x-this.r,this.y-this.r):(e.save(),e.fillStyle=this.color,e.shadowBlur=2*this.r,e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI,!1),e.closePath(),e.fill(),e.restore())},cache:function(){this.cacheCtx.save(),this.cacheCtx.fillStyle=this.color,this.cacheCtx.shadowColor="white",this.cacheCtx.shadowBlur=2*this.r,this.cacheCtx.beginPath(),this.cacheCtx.arc(3*this.r,3*this.r,this.r,0,2*Math.PI),this.cacheCtx.closePath(),this.cacheCtx.fill(),this.cacheCtx.restore()},move:function(){this.y-=h.move_distance,this.y<=-10&&(this.y+=n+10),this.draw()},die:function(){s[this.id]=null,delete s[this.id]}},x.prototype={draw:function(){this.useCache?e.drawImage(this.dotCanvas,this.x-3*this.r,this.y-3*this.r):(e.save(),e.fillStyle=this.color,e.shadowColor="white",e.shadowBlur=2*this.r,e.beginPath(),e.arc(this.x,this.y,this.r,0,2*Math.PI,!1),e.closePath(),e.fill(),e.restore())},cache:function(){this.dotCtx.save(),this.dotCtx.a-=this.aReduction,this.dotCtx.color="rgba(255,255,255,"+this.dotCtx.a+")",this.dotCtx.fillStyle=this.dotCtx.color,this.dotCtx.shadowColor="white",this.dotCtx.shadowBlur=2*this.r,this.dotCtx.beginPath(),this.dotCtx.arc(3*this.r,3*this.r,this.r,0,2*Math.PI,!1),this.dotCtx.closePath(),this.dotCtx.fill(),this.dotCtx.restore()},link:function(){if(0!=this.id){var t=m(this.id,1),i=m(this.id,2),h=m(this.id,3),s=m(this.id,4);t&&(e.strokeStyle=this.linkColor,e.moveTo(t.x,t.y),e.beginPath(),e.lineTo(this.x,this.y),0!=i&&e.lineTo(i.x,i.y),0!=h&&e.lineTo(h.x,h.y),0!=s&&e.lineTo(s.x,s.y),e.stroke(),e.closePath())}},move:function(){this.a-=this.aReduction,this.a<=0?this.die():(this.dotCtx.a-=this.aReduction,this.dotCtx.color="rgba(255,255,255,"+this.dotCtx.a+")",this.color="rgba(255,255,255,"+this.a+")",this.linkColor="rgba(255,255,255,"+this.a/4+")",this.x=this.x+Math.cos(w(this.dir))*this.speed,this.y=this.y+Math.sin(w(this.dir))*this.speed,this.draw(),this.link())},die:function(){o[this.id]=null,delete o[this.id]}},window.onmousemove=function(t){d=!0,l=t.clientX,u=t.clientY,clearInterval(c),c=setInterval(function(){d=!1},1e3)},r=document.documentElement.clientWidth,n=document.documentElement.clientHeight,a.setAttribute("width",r),a.setAttribute("height",n),i=function(){return this||(0,eval)("this")}(),"undefined"!=typeof module&&module.exports?module.exports=C:"function"==typeof define&&define.amd?define(function(){return C}):!("CanvasStar"in i)&&(i.CanvasStar=C)}();